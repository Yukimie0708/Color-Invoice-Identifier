<?php

require 'vendor/autoload.php';

use League\ColorExtractor\Color;
use League\ColorExtractor\ColorExtractor;
use League\ColorExtractor\Palette;

if ($_SERVER['REQUEST_METHOD'] === 'POST' && isset($_FILES['image'])) {
    $uploadedFile = $_FILES['image'];

    if ($uploadedFile['error'] === UPLOAD_ERR_OK) {
        $tmpFileName = $uploadedFile['tmp_name'];

        $image = imagecreatefromstring(file_get_contents($tmpFileName));

        $palette = Palette::fromGD($image);
        $extractor = new ColorExtractor($palette);

        // How many colors you extract
        $colors = $extractor->extract(10);

        // Sample color names array
        $colorNames = [
            '255,0,0' => 'Red',
            '0,255,0' => 'Green',
            '0,0,255' => 'Blue',
            '255,255,0' => 'Yellow',
            '128,0,128' => 'Purple',
            '255,165,0' => 'Orange',
            '255,192,203' => 'Pink',
            '165,42,42' => 'Brown',
            '128,128,128' => 'Gray',
            '0,0,0' => 'Black',
            '248,136,0' => 'Orange',  // RGB(248, 136, 0)
            '249,0,0' => 'Red',      // RGB(249, 0, 0)
            '77,0,0' => 'Maroon',    // RGB(77, 0, 0)
            '134,0,0' => 'Dark Red',  // RGB(134, 0, 0)
            '39,0,0' => 'Blackish Red',  // RGB(39, 0, 0)
            '198,0,0' => 'Deep Red',  // RGB(198, 0, 0)
            '255,104,27' => 'Orange', // RGB(255, 104, 27)
            '94,43,0' => 'Brown',     // RGB(94, 43, 0)
            '157,78,0' => 'Brownish', // RGB(157, 78, 0)
            '197,131,34' => 'Orange-Brown',  // RGB(197, 131, 34)
            
            //GRAY
    '220, 220, 220' =>'Gainsboro',
    '211, 211, 211' =>'LightGray',
    '192, 192, 192' =>'Silver',
    '169, 169, 169' =>'DarkGray',
    '128, 128, 128' =>'Gray',
    '105, 105, 105' =>'DimGray',
    '119, 136, 153' =>'LightSlateGray',
    '112, 128, 144' =>'SlateGray',
    '47, 79, 79' =>'DarkSlateGray',
    '0, 0, 0' =>'Black',
    '59, 68, 75' =>'Arsenic',
    '178, 190, 181' =>'Ash Gray',
    '84, 98, 111' =>'Black Coral',
    '98, 93, 93' =>'Carbon Gray',
    '54, 69, 79' =>'Charcoal',
    '85, 85, 85' =>'Davys Gray',
    '74, 100, 108' =>'Deep Space Sparkle',
    '105,105,105' =>'Dim Gray',
    '182, 182, 180' =>'Gray Cloud',
    '92, 88, 88' =>'Gray Dolphin',
    '209, 208, 206' =>'Gray Goose',
    '80, 74, 75' =>'Gray Wolf',
    '52, 52, 52' =>'Jet',
    '109, 123, 141' =>'Light Slate Gray',
    '190, 190, 190' =>'Medium Gray',
    '102, 106, 109' =>'Nevada',
    '114, 116, 114' =>'Nickel',
    '132, 132, 130' =>'Old Silver',
    '65, 74, 76' =>'Outer Space',
    '138, 127, 141' =>'Rocket Metallic',
    '115, 124, 161' =>'Slate Blue',
    '101, 115, 131' =>'Slate Gray',
    '115, 130, 118' =>'Smoke',
    '114, 110, 109' =>'Smokey Gray',
    '117, 117, 117' =>'Sonic Gray',
    '152, 152, 152' =>'Spanish Gray',
    '146, 142, 133' =>'Stone Gray',
    '79, 102, 106' =>'Stormcloud',
    '53, 56, 57' =>'Onyx',
    '229, 228, 226' =>'Platinum',
    '245, 245, 245' =>'White Smoke',
    '232, 233, 235' =>'Bright Gray',
    '116, 109, 105' =>'Dark Silver',
    '204, 205, 198' =>'Pastel Gray',
    '242, 243, 245' =>'White Gray',
    '152, 150, 146' =>'Vintage Gray',
    '218, 218, 218' =>'Gentle Gray',
    '161, 161, 161' =>'Perfect Gray',
    '75, 78, 83' =>'Graphite Gray',
    '166, 171, 165' =>'Rustic Gray',
    '182, 179, 168' =>'Silk Gray',
    '165, 165, 168' =>'Matte Silver',
    '195, 199, 199' =>'Pure Silver',
    '51, 51, 51' =>'Dark Charcoal',
    '110, 98, 89' =>'Warm Gray',
    '139, 131, 126' =>'Dull Gray',
    '31, 32, 34' =>'Rich Gray',
    '219, 226, 233' =>'Chrome',
    '175, 173, 169' =>'Glossy Gray',
    '133, 138, 126' =>'Cement Gray',
    '136, 139, 141' =>'Steel Gray',
    '84, 88, 81' =>'Camouflage Gray',
    '142, 141, 140' =>'Fashion Gray',
    '137, 142, 140' =>'Neutral Gray',
    '165, 156, 148' =>'Iron',
    '138, 141, 143' =>'True Silver',
    '181, 186, 182' =>'Storm Gray',
    '199, 198, 193' =>'Harbor Gray',
    '62, 66, 75' =>'Anchor',
    '120, 114, 118' =>'Fossil',
    //WHITE
    '255, 255, 255' => 'White',
    '255, 250, 250' => 'Snow',
    '240, 255, 240' => 'HoneyDew',
    '245, 255, 250' => 'MintCream',
    '240, 255, 255' => 'Azure',
    '240, 248, 255' => 'AliceBlue',
    '248, 248, 255' => 'GhostWhite',
    '245, 245,245' => 'WhiteSmoke',
    '255, 245, 238' => 'SeaShell',
    '245, 245, 220' => 'Beige',
    '253, 245, 230' => 'OldLace',
    '255, 250, 240' => 'FloralWhite',
    '255, 255, 240' => 'Ivory',
    '250, 235, 215' => 'AntiqueWhite',
    '250, 240, 230' => 'Linen',
    '255, 240, 245' => 'LavenderBlush',
    '255, 228, 225' => 'MistyRose',	
    //BROWN
    '255, 248, 220' => 'Cornsilk',
    '255, 235, 205' => 'BlanchedAlmond',
    '255, 228, 196' => 'Bisque',
    '255, 222, 173' => 'NavajoWhite',
    '245, 222, 179' => 'Wheat',
    '222, 184, 135' => 'BurlyWood',
    '210, 180, 140' => 'Tan',	
    '188, 143, 143' => 'RosyBrown',
    '244, 164, 96' => 'SandyBrown',
    '218, 165, 32' => 'Goldenrod',
    '184, 134, 11' => 'DarkGoldenrod',
    '205, 133, 63' => 'Peru',
    '210, 105, 30' => 'Chocolate',
    '139, 69, 19' => 'SaddleBrown',
    '160, 82, 45' => 'Sienna',
    '165, 42, 42' => 'Brown',
    '128, 0, 0' => 'Maroon',
    '239, 222, 205' => 'Almond',
    '159, 129, 112' => 'Beaver',
    '61, 43, 31' => 'Bistre',
    '227, 218, 201' => 'Bone',
    '205, 127, 50' => 'Bronze',
    '75, 54, 33' => 'Cafe noir',	
    '250, 214, 165' => 'Champagne',
    '210, 105,30' => 'Cinnamon',
    '111, 78, 55' => 'Coffee',
    '112, 66, 65' => 'Deep coffee',
    //YELLOW
    '255, 215, 0' => 'Gold',
    '255, 255, 0' => 'Yellow',
    '255, 255, 224' => 'LightYellow',
    '255, 250, 205' => 'LemonChiffon',
    '250, 250, 210' => 'LightGoldenrodYellow',
    '255, 239, 213' => 'PapayaWhip',
    '255, 228, 181' => 'Moccasin',
    '255, 218, 185' => 'PeachPuff',
    '238, 232, 170' => 'PaleGoldenrod',
    '240, 230, 140' => 'Khaki',
    '189, 183, 107' => 'DarkKhaki',			
    '255, 253, 55' => 'Sunshine Yellow',
    '255, 239, 0' => 'Canary Yellow',	
    '253, 255, 0' => 'Lemon Yellow',	
    '218, 165,32' => 'Goldenrod',
    '244, 196, 48' => 'Saffron',
    '228, 208, 10' => 'Citrine',
    '238, 220, 130' => 'Flax',
    '240, 230,140' => 'Light Khaki',
    '252, 232, 131' => 'Clover Lime',
    '238, 237, 9' => 'Xanthic',
    '250, 218, 94' => 'Royal Yellow	',
    '255, 255, 204' => 'Cream',
    '255, 253, 1' => 'Bright Yellow',
    '207, 255, 4' => 'Neon Yellow',
    '213, 182, 10' => 'Dark Yellow',
    '255, 218, 3' => 'Sunflower',	
    '252, 226, 5' => 'Bumblebee',	
    '255, 253, 116' => 'Butter',
    '255, 227, 110' => 'Yellow Tan',
    '255, 211, 0' => 'Cyber Yellow',	
    '255, 225, 53' => 'Banana',
    '252, 209, 42' => 'Tuscany',	
    '255, 195, 11' => 'Honey',
    '255, 191, 0' => 'Amber',
    '245, 245,220' => 'Beige',
    '254, 220, 86' => 'Mustard',
    '248, 222, 126' => 'Mellow Yellow',	
    '204, 160, 29' => 'Lemon Curry',
    '255, 254, 113' => 'Pastel Yellow',	
    '223, 255, 0' => 'Chartreuse (traditional)',				
    '238, 230, 0' => 'Titanium Yellow',	
    '204, 255, 0' => 'Fluorescent Yellow',	
    '225, 189, 39' => 'Durian Yellow',		
    '254, 254, 34' => 'Laser Lemon	',
    '255, 204, 0' => 'Tangerine Yellow',		
    '115, 112, 0' => 'Bronze Yellow',
    '206, 176, 13' => 'Yellow Jasmine',	
    '226, 176, 81' => 'Yellow Jasmine',		
    '255, 218, 41' => 'Yolk Yellow (Pantone)',
    '254, 222, 23' => 'Vibrant Yellow',
    '241, 191, 112' => 'Fire Yellow',
    '239, 220, 117' => 'Buff Yellow',
    '247, 208, 0' => 'Yellow Cream',
    '237, 217, 76' => 'Matte Yellow',
    '239, 208, 51' => 'Aesthetic Yellow',
    '226, 196, 0' => 'Rustic Yellow',
    '240, 226, 123' => 'Retro Yellow',
    '234, 206, 9' => 'Deep Yellow',
    '222, 202, 87' => 'Dull Yellow',	
    '222, 202,87' => 'Hot Yellow',	
    '251, 236, 93' => 'Corn',
    '240, 225, 48' => 'Dandelion',	
    '252, 184, 16' => 'Marigold',
    '248, 220, 117' => 'Daisy Yellow',
            
        
    //PURPLE
    '230, 230, 250' => 'Lavender',
    '216, 191, 216' => 'Thistle',
    '221, 160, 221' => 'Plum',
    '143, 0, 255' => 'Violet',
    '218, 112, 214' => 'Orchid',
    '255, 0, 255' => 'Fuchsia',
    '255, 0,255' => 'Magenta',
    '186, 85, 211' => 'MediumOrchid',
    '147, 112, 219' => 'MediumPurple',
    '102, 51, 153' => 'RebeccaPurple',
    '138, 43, 226' => 'BlueViolet',
    '148, 0, 211' => 'DarkViolet',
    '153, 50, 204' => 'DarkOrchid',
    '139, 0, 139' => 'DarkMagenta',
    '128, 0, 128' => 'Purple',
    '75, 0, 130' => 'Indigo',
    '106, 90, 205' => 'SlateBlue',
    '72, 61, 139' => 'DarkSlateBlue',			
    '123, 104, 238' => 'MediumSlateBlue',
    '250, 230, 250' => 'Pale Purple',
    '222, 111, 161' => 'Liserian Purple',
    '197, 75, 140' => 'Mulberry',
    '183, 104, 162' => 'Pearly Purple',
    '154, 78, 174' => 'Purpureus',
    '120, 24, 74' => 'Pansy Purple',
    '48, 25, 52' => 'Dark Purple',
    '178, 132, 190' => 'African Violet',
    '153, 102, 204' => 'Amethyst',
    '152, 103, 197' => 'Iris',
    '111, 45, 168' => 'Grape Color',
    '44, 4, 28' => 'Wine',
    '100, 83, 148' => 'Ultra Violet',
    '49, 20, 50' => 'Eggplant',
    '41, 9, 22' => 'Raisin',
    '103, 3, 47' => 'Jam',
    '163, 44, 196' => 'Magenta Purple',
    '121, 104, 120' => 'Old Lavender',
    '96, 47, 107' => 'Imperial Purple',
    '182, 95, 207' => 'Lilac',
    '182, 181, 216' => 'Lavender Gray',
    '85, 26, 139' => 'Purple 4',
    '138, 36, 78' => 'Cardinal',
    '82, 79, 129' => 'Deep Purple',
    '71, 36, 60' => 'Purple Violet',
    //ORANGE
    '255, 127, 80' => 'Coral',
    '255, 69, 0' => 'OrangeRed',
    '255, 140, 0' => 'DarkOrange',
    '255, 165, 0'  => 'Orange',
    '255, 94, 14' => 'Vivid Orange',
    '226, 99, 16' => 'Metallic Orange',
    '245, 118, 26' => 'Pumpkin',
    '253, 103, 58' => 'Smashed Pumpkin',	
    '255, 168, 54' => 'Yellow-Orange	',
    '237, 145, 33' => 'Carrot Orange',
    '255, 79, 0' => 'International Orange',
    '240, 97, 5' => 'Spanish Orange',
    '247, 135, 2' => 'Tangerine',
    '255, 143, 0' => 'Princeton Orange',
    '251, 79, 20' => 'Orioles Orange',
    '255, 165, 44' => 'Deep Saffron',
    '195, 82, 20' => 'Alloy Orange',
    '238, 89, 33' => 'Halloween Orange',
    '252, 76, 2' => 'Tangelo',
    '232, 150, 17' => 'Gamboge',
    '254, 186, 79' => 'Pastel Orange',
    '227, 74, 39' => 'Flame',
    '242, 110, 1' => 'Philippine Orange',
    '255, 153, 68' => 'Royal Orange',
    '215, 83, 65' => 'Dark Coral',
    '251, 136, 66' => 'Mango Tango',
    '255, 159, 0' => 'Orange Peel',
    '236, 88, 0' => 'Persimmon',
    '217, 144, 88' => 'Persian Orange',
    '251, 206, 177' => 'Apricot Orange',
    '254, 216, 177' => 'Light Orange',
    '223, 145, 102' => 'Melon Orange',
    '255, 173, 0' => 'Neon Orange',
    '255, 204, 153' => 'Peach Orange',
    '232, 147, 98' => 'Squash Orange',
    '231, 132, 0' => 'Glossy Orange',
    '252, 190, 133' => 'Baby Orange',
	//PINK
    '255, 192, 203' => 'Pink',
    '255, 182, 193' => 'LightPink',
    '255, 105, 180' => 'HotPink',
    '255, 20, 147' => 'DeepPink',
    '199, 21, 133' => 'MediumVioletRed',
    '219, 112, 147' => 'PaleVioletRed',
    '252, 108, 133' => 'Watermelon',
    '252, 142, 172' => 'Flamingo',
    '248, 131, 121'	=> 'Coral',
    '255, 153, 153'	=>  'Salmon',
    '255, 209, 220'	=> 'Pastel pink',
    '255, 183, 197'	=> 'Cherry blossom',
    '255, 193, 204'	=> 'Bubblegum',
    '244, 194, 194'	=> 'Baby pink',
    '231, 84, 128' =>  'Dark pink',
    '255, 0, 127' => 'Bright pink',
    '169, 64, 100' => 'Rouge',
    '255, 110, 199'	=> 'Neon Pink',
    '222, 93, 131' => 'Blush',
    '193, 84, 193' => 'Fuchsia',
    '224, 176, 255' =>'Mauve',
    '218, 112,214' => 'Orchid',
    '255,0,255' => 'Magenta', 		
    '255, 166, 201' => 'Carnation',
    '255, 142, 142' => 'Tulip pink',
    '244, 194,194' => 'Tea rose',
    '255, 188, 217'	=> 'Cotton Candy',
    '239, 187, 204'	=> 'Cameo pink',
    '246, 74, 138' => 'French pink',
    '232, 136, 138' => 'Strawberry',
    '247, 127, 190' => 'Persian pink',
    '222, 49, 99' => 'Cherry pink',
    '205, 91, 69' => 'Dark coral',
    '250, 209, 175' => 'Peach',
    '183, 110, 121' => 'Rose Gold',
    '224, 33, 138' => 'Barbie Pink',
    '197, 75,140' => 'Mulberry',
    '245, 105, 145' => 'Light Crimson',
    '255, 92, 205' => 'Light Deep Pink',
    '212, 112, 162' => 'Wild Orchid',
    '231, 172, 207' => 'Pink Pearl',
    '247, 188, 172' => 'Melon',
    '238, 145, 141' => 'Sweet Pink',
    '224, 112, 124' => 'Grapefruit Pink',
    '206, 116, 167' => 'Passion Pink',
    '255, 102, 204' => 'Rosy Pink',
    //RED
    '205, 92, 92'  => 'Indian Red',
    '240, 128, 128' => 'LightCoral',
    '250, 128, 114'   => 'Salmon',
    '233, 150, 122'  => 'DarkSalmon',
    '255, 160, 122'  => 'LightSalmon',
    '220, 20, 60'  => 'Crimson',
    '255, 0, 0'  => 'Red',
    '178, 34, 34'  => 'FireBrick',
    '139, 0, 0'  => 'DarkRed',
    '237, 41, 57'  => 'Imperial Red',
    '255, 36, 0'  => 'Scarlet',
    '124, 10, 2'  => 'Barn Red',
    '194, 24, 7'  => 'Chili Red	',
    '224, 17, 95'  => 'Ruby',
    '128,0,0'  => 'Maroon',
    '164, 90, 82'  => 'Redwood',
    '150, 0, 24'  => 'Carmine',
    '234, 60, 83'  => 'Desire',
    '126, 25, 27'  => 'Vermilion',
    '210, 31, 60'  => 'Raspberry',
    '255, 8, 0'  => 'Candy Apple',
    '202, 52, 51'  => 'Persian',
    '180, 55, 87'  => 'Hibiscus',
    '255, 40, 0'  => 'Ferrari',
    '94, 25, 20'  => 'Sangria',
    '66, 13, 9'  => 'Mahogany',
    '141, 2, 31'  => 'Burgundy	',
    '147, 58, 22'  => 'Rust	',
    '255, 99, 71'  => 'Tomato',
    '255, 69,0'  => 'Orange Red',
    '251, 96, 127'  => 'Light Brick',
    '126, 40, 17'  => 'Brick',
    '102, 0, 0'  => 'Blood Red',
    '244, 0, 9'  => 'Coke Red',
    '255, 127,80'  => 'Coral Red',
    '226, 88, 34'  => 'Flame Red',
    '115, 54, 53' => 'Garnet Red',
    '255, 0, 254'  => 'Fuchsia',
    '255, 105, 97'  => 'Pastel Red',
    '255,255,255' => 'White',
    '0,255,1' => 'Lime',
    '0,255,255'  => 'Cyan',
    '192,192,192' => 'Silver',
    '248, 136,0'  => 'Saffron Blaze',
    '128,128,0'  => 'Olive',
    '128, 128, 0' => 'Olive Green',
    '152, 255, 152' => 'Mint Green',
    '53, 94, 59' => 'Hunter Green',
    '1, 121, 111' => 'Pine Green',

    '173, 255, 47'=>	'GreenYellow',
    '127, 255, 7'=>	'Chartreuse',
     '124, 252, 0'=>	'LawnGreen',
    '50, 205, 50'=>	'LimeGreen',
    '152, 251, 152'=>	'PaleGreen',
    '144, 238, 144'=>	'LightGreen',
    '0, 250, 154'=>	'MediumSpringGreen',
    '0, 255, 127'=>	'SpringGreen',
    '60, 179, 113'=>	'MediumSeaGreen',
    '46, 139, 87'=>	'SeaGreen',
    '34, 139, 34'=>	'ForestGreen',
     '0, 100, 0'=>	'DarkGreen',
    '154, 205, 50'=>	'YellowGreen',
    '107, 142, 35'=>	'OliveDrab',
    '85, 107, 47'=>	'DarkOliveGreen',
    '102, 205, 170'=>	'MediumAquamarine',
    '143, 188, 139'=>	'DarkSeaGreen',
    '32, 178, 170'=>	'LightSeaGreen',
    '0, 139, 139'=>	'DarkCyan',
    '0, 128, 128'=>	'Teal',


    '1, 255, 254'=> 'Aqua',
    '0, 255, 255'=> 'Cyan',
    '224, 255, 255'=> 'LightCyan',
    '175, 238, 238' => 'PaleTurquoise',
    '127, 255, 212' => 'Aquamarine',	
    '64, 224, 208'=> 'Turquoise',	
    '72, 209, 204'=> 'MediumTurquoise',
    '0, 206, 209'=> 'DarkTurquoise',	
    '95, 158, 160 '=> 'CadetBlue',	
    '70, 130, 180'=> 'SteelBlue',	
    '176, 196, 222'=> 'LightSteelBlue',	
    '176, 224, 230'=> 'PowderBlue',	
    '173, 216, 230'=> 'LightBlue',	
    '135, 206, 235'=> 'SkyBlue',	
    '135, 206, 250'=> 'LightSkyBlue',	
    '0, 191, 255'=> 'DeepSkyBlue',	
    '30, 144, 255'=> 'DodgerBlue',	
    '100, 149, 237'=> 'CornflowerBlue',	
    '123, 104, 240'=> 'MediumSlateBlue',	
    '65, 105, 225'=> 'RoyalBlue',	
    '0, 0, 255'=> 'Blue',	
    '0, 0, 205'=> 'MediumBlue',	
    '0, 0, 139'=> 'DarkBlue',	
    '0, 0, 128'=> 'Navy',	
    '25, 25, 112'=> 'MidnightBlue',	
    '178, 255, 255'=> 'Celeste',	
    '175, 228, 238'=> 'Light turquoise',	
    '0, 255, 239'=> 'Turquoise blue',	
    '173, 216, 240'=> 'Sky blue',	
    '125, 249, 255'=> 'Electric blue',	
     '137, 207, 240'=> 'Baby blue',	
     '129, 216, 208'=> 'Tiffany blue',	
    '70, 130, 170'=> 'Steel blue',	
    '15, 82, 186'=> 'Sapphire blue',	
    '0, 127, 255'=> 'Azure',	
    '0, 53, 107'=> 'Yale blue',	
    '0, 35, 102'=> 'Traditional Royal blue',	
     '67, 107, 149'=> 'Queen blue',	
    '0, 90, 146'=> 'Imperial blue',	
    '21, 244, 238'=> 'Fluorescent blue',	
    '10, 255, 255'=> 'Aqua Blue',	
    '107, 202, 226'=> 'Aquamarine Blue',	
    '108, 180, 238'=> 'Argentina Blue',	
    '79, 134, 247'=> 'Berry Blue',	
    '102, 153, 204'=> 'Blue-Gray',	
    '12, 175, 255 '=> 'Chlorine Blue',	
    '21, 96, 189'=> 'Denim Blue',	
    '0, 142, 151'=> 'Dolphins Aqua',	
    '44, 57, 104'=> 'Ford Blue',	
    '153, 255, 255'=> 'Ice Blue',	
    '63, 0, 255' => 'Indigo Blue',	
    '90, 79, 207'=> 'Iris Blue',	
    '0, 119, 192'=> 'Magic Blue',	
    '77, 77, 255 '=> 'Neon Blue',	
    '0, 157, 196'=> 'Ocean Blue',	
    '0, 24, 168'=> 'Pantone Blue',	
    '0, 95, 105'=> 'Peacock Blue',	
    '28, 57, 187'  => 'Persian Blue',	
    '106, 90, 215'=> 'Slate Blue',	
    '50, 74, 178'=> 'Violet Blue',	

        ];

        // Function to find the nearest RGB value
        function findNearestRGB($color, $colorNames) {
            $minDistance = PHP_INT_MAX;
            $nearestRGB = null;

            foreach ($colorNames as $rgb => $name) {
                list($r, $g, $b) = explode(',', $rgb);
                $distance = sqrt(pow($r - $color['red'], 2) + pow($g - $color['green'], 2) + pow($b - $color['blue'], 2));

                if ($distance < $minDistance) {
                    $minDistance = $distance;
                    $nearestRGB = $rgb;
                }
            }

            return $nearestRGB;
        }

        $colorData = array_map(function ($color) use ($colorNames) {
            $hex = Color::fromIntToHex($color);
            list($red, $green, $blue) = sscanf($hex, "#%02x%02x%02x");

            // Get color name from the array using RGB values
            $rgbKey = "$red,$green,$blue";
            $colorName = $colorNames[$rgbKey] ?? null;

            // If there's no exact match, find the nearest RGB value
            if (!$colorName) {
                $nearestRGB = findNearestRGB(['red' => $red, 'green' => $green, 'blue' => $blue], $colorNames);
                $colorName = $colorNames[$nearestRGB];
            }

            return [
                'hex' => $hex,
                'rgb' => "rgb($red, $green, $blue)",
                'red' => $red,
                'green' => $green,
                'blue' => $blue,
                'color_name' => $colorName,
            ];
        }, $colors);

        $response = ['colors' => $colorData];
        header('Content-Type: application/json');
        echo json_encode($response);

        imagedestroy($image);
    } else {
        echo 'Error uploading file.';
    }
}
